<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>
      {{ if .IsHome }}{{ site.Title }}{{ else }}{{ .Title }} · {{ site.Title }}{{ end }}
    </title>

    {{ $css := resources.Get "css/main.css" | minify | fingerprint }}
    <link rel="stylesheet" href="{{ $css.RelPermalink }}" integrity="{{ $css.Data.Integrity }}" />
  </head>

  <body>
    <header class="topbar">
      <div class="container topbar-inner">
        <a class="brand" href="{{ "/" | relURL }}">NextWork Lab.</a>

        <nav class="nav" aria-label="Global navigation">
          <a href="#about">About</a>
          <a href="#cbw">CBW</a>
          <a href="#exgel">exgel</a>
          <a href="#contact">Contact</a>
        </nav>
      </div>
    </header>

    <main class="container">
      {{ block "main" . }}{{ end }}
    </main>

    <footer class="footer">
      <div class="container">
        <span class="muted">© {{ now.Year }} NextWork Lab.</span>
      </div>
    </footer>

    <script>
      (function () {
        function ensureDefaultHash() {
          if (!window.location.hash || window.location.hash.length <= 1) {
            window.location.replace("#about");
          }
        }

        function setActiveNav(hash) {
          var links = document.querySelectorAll(".nav a[href^='#']");
          links.forEach(function (a) {
            a.classList.toggle("is-active", a.getAttribute("href") === hash);
          });
        }

        function showPanel(hash) {
          var id = hash.slice(1);
          var panels = document.querySelectorAll(".panel");
          panels.forEach(function (p) { p.style.display = "none"; });

          var target = document.getElementById(id);
          if (target && target.classList.contains("panel")) {
            target.style.display = "block";
          } else {
            var about = document.getElementById("about");
            if (about) about.style.display = "block";
            hash = "#about";
          }

          setActiveNav(hash);
          window.scrollTo(0, 0);
        }

        function render() {
          var hash = window.location.hash || "#about";
          showPanel(hash);
        }

        document.addEventListener("DOMContentLoaded", function () {
          ensureDefaultHash();
          render();
        });

        window.addEventListener("hashchange", render);
      })();
    </script>
  </body>
</html>
